<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_black</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Initiate

depth = TRANS;


state = "fade in" //  *create -&gt; fade in -&gt; waiting -&gt; fade out -&gt; *destroy
image_alpha = 0; //alpha value

//reset units and propeties
            with(obj_unit){
                state = "idle";
                if ownership = global.P_Turn.number state = "exhaust";
                image_index = 21;
                isStanding = false ;
                }
            with (obj_property) isStanding = false;
            //set is standing for all players
            //scr_updateStanding(global.P_Turn);
            scr_updateStanding_global();


</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///save file send old

/*
if(serverMode==1){        
scr_quick_save("quicksave.ubq"); 
//Send save file to client - Chris
var saveBuffer= buffer_load("quicksave.ubq");
var sendBuffer = buffer_create(256, buffer_grow, 1);
var bufferName = "netGameData"
 //Tell client how much sprite data to expect
buffer_write(sendBuffer, buffer_u32, buffer_get_size(saveBuffer));

//Send name of object so the client knows what to save it as
buffer_write(sendBuffer, buffer_string, bufferName);
}
if(serverMode==1){
    network_send_packet(portNum, sendBuffer, buffer_tell(sendBuffer));
 }else{
    network_send_packet(cSocket, sendBuffer, buffer_tell(sendBuffer));
 }*/
//end of packet send

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///save file send new
//auto save turn
        scr_quick_save("quicksave2.ubq"); 
        scr_quick_save("quicksave.ubq"); 
        //Send save file to client - Chris
        var saveBuffer= buffer_load("quicksave.ubq");
        var sendBuffer = buffer_create(256, buffer_grow, 1);
         buffer_write(sendBuffer, buffer_u16, 100);
         //Tell client how much sprite data to expect
        buffer_write(sendBuffer, buffer_u32, buffer_get_size(saveBuffer));
        show_debug_message("saveBuffer is " + string(buffer_get_size(saveBuffer)) + " bytes large");
        buffer_copy(saveBuffer, 0, buffer_get_size(saveBuffer), sendBuffer, buffer_get_size(sendBuffer));
        var packNum = ceil(buffer_get_size(sendBuffer)/1450);
       //buffer_write(sendBuffer, buffer_string, bufferName);
        show_debug_message("Sending save data: " + string(buffer_get_size(sendBuffer)) + " in " + string(buffer_tell(sendBuffer)) + " packets.");
        if(global.turns&gt;0){
            if(serverMode==1)
                  var sent = network_send_packet(ds_list_find_value(socketlist, 0), sendBuffer, buffer_get_size(sendBuffer));
            else
                  var sent = network_send_packet(cSocket, sendBuffer, buffer_tell(sendBuffer));
            show_debug_message(string(sent) + "bytes of data sent to " + string(ds_list_find_value(socketlist, 0)));
        }
       
        global.turns++;
        //end of packet send
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// fading and key check






switch state {
    case "fade in" :
        if (image_alpha &gt; 1) {
            state = "waiting"
            
            //change Day
            if global.P_Turn.number == global.last_player global.Day +=1;
            //UPKEEP PREP
            show_debug_message("NEW TURN");
            //change player
            changeplayer = ds_queue_dequeue(global.player_q);
            ds_queue_enqueue(global.player_q,changeplayer);
            //update P _turn 
            global.P_Turn = ds_queue_head(global.player_q) ;
            //reset viewport
            view_xview[0] = global.P_Turn.save_view_pos_x;
            view_yview[0] = global.P_Turn.save_view_pos_y;
            //chang phase
            global.Phaze = "Waiting";
 
            //reset units and propeties
            with(obj_unit)
                    {
                    state = "idle";
                    if ownership = global.P_Turn.number state = "exhaust";
                    image_index = 21;
                    isStanding = false ;
                    if( ownership  = global.P_Turn.number )
                        {
                        //cop on or off
                        COP  = false;
                        SCOP = false;
                        }
                    }
            with (obj_property) isStanding = false;
            //set is standing for all players
            scr_updateStanding_global();
            
            //deactivate COP and SCOP
            global.P_Turn.CO.COP_on = false ;
            global.P_Turn.CO.SCOP_on = false ;
            //reset visibility af all positions
            scr_globalVisionReset();
            scr_updateGlobalVision();
            //update boarder for new turn
            scr_globalRadioCheck();
            scr_update_radioBoarder();   
          
        //change cursor pose to saved (to player)
        
        //auto save turn
        scr_quick_save("quicksave.ubq"); 
        

        
            
            }
        else{
            image_alpha += 0.1 ;
            }
        break;
    
    case "waiting" :
        image_alpha = 1;
        if ((keyboard_check_pressed(global.keyCONFIRM) or mouse_check_button_pressed(mb_left)) or global.autoTurn){
            //switch to "fad out"
            state = "fade out"
            //change phasze to "main"
            global.Phaze = "Upkeep";
            //pre-check standing
            //scr_updateStanding_global();
            //scr_updateGlobalVision(); 
            }
        break;
    case "fade out" :
    
        if image_alpha &lt; 0 {
        instance_create(0,0,obj_upkeep);
        instance_destroy();
            }
            
        else{
            image_alpha -= 0.1 ;
            }
        break;
    }
    

    


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="64">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///trouble shoot
//draw_text(0,0, global.Phaze + string(global.P_Turn.number))


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>x = view_xview;
y = view_yview;

draw_self();
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
